// Language Translations
const translations = {
    en: {
        // Navigation
        "signIn": "Sign In",
        "getStarted": "Get Started Free",
        
        // Hero Section
        "hero.title": "Your Personal AI <span>Health Companion</span>",
        "hero.subtitle": "Automating hospital & insurance workflows with intelligence. Streamline medical coding, claims processing, and patient management with our AI-powered platform.",
        "hero.startTrial": "Start Free Trial",
        "hero.watchDemo": "Watch Demo",
        "hero.accuracy": "Accuracy Rate",
        "hero.timeSaved": "Time Saved",
        "hero.support": "AI Support",
        "hero.flowTitle": "AI Processing Flow",
        "hero.flowSubtitle": "Document → Code → Claim",
        "hero.upload": "Upload",
        "hero.aiCoding": "AI Coding",
        "hero.claim": "Claim",
        
        // Features
        "features.title": "Powerful Features",
        "features.subtitle": "Everything you need to streamline healthcare administration",
        "features.aiCoding": "AI-Powered Coding",
        "features.aiCodingDesc": "Automatically suggests accurate ICD-10 and CPT codes from medical documents with 95% accuracy.",
        "features.claims": "Instant Claims Processing",
        "features.claimsDesc": "Generate and submit insurance claims in seconds instead of hours. Real-time tracking and status updates.",
        "features.hipaa": "HIPAA Compliant",
        "features.hipaaDesc": "Bank-level security and HIPAA compliance ensure your patient data is always protected.",
        "features.analytics": "Analytics Dashboard",
        "features.analyticsDesc": "Comprehensive insights into coding accuracy, claim status, and workflow efficiency.",
        "features.automation": "Workflow Automation",
        "features.automationDesc": "Automate repetitive tasks and streamline hospital & insurance workflows end-to-end.",
        "features.assistant": "AI Assistant",
        "features.assistantDesc": "24/7 AI assistant to answer questions, provide coding guidance, and resolve queries instantly.",
        
        // How It Works
        "works.title": "How It Works",
        "works.subtitle": "Three simple steps to transform your healthcare administration",
        "works.step1": "Upload Documents",
        "works.step1Desc": "Upload medical documents, clinical notes, or patient records through our secure portal.",
        "works.step2": "AI Processes & Codes",
        "works.step2Desc": "Our AI analyzes documents and suggests accurate medical codes with confidence scores.",
        "works.step3": "Generate Claims",
        "works.step3Desc": "Create insurance claims with one click and track their status in real-time.",
        
        // Testimonials
        "testimonials.title": "Trusted by Healthcare Professionals",
        "testimonials.subtitle": "See what our users say about Mediमित्र",
        "testimonials.quote": "\"Mediमित्र has reduced our coding time by 70% and improved accuracy significantly. The AI suggestions are incredibly accurate and have streamlined our entire workflow.\"",
        "testimonials.author": "Dr. Sarah Davis",
        "testimonials.position": "Chief Medical Officer, City Hospital",
        
        // CTA
        "cta.title": "Ready to Transform Your Healthcare Workflow?",
        "cta.subtitle": "Join thousands of healthcare professionals using Mediमित्र",
        "cta.button": "Start Your Free Trial",
        "cta.noCard": "No credit card required",
        "cta.quickStart": "Get started in 2 minutes",
        
        // Footer
        "footer.description": "Your personal AI health companion for automating hospital and insurance workflows with intelligence.",
        "footer.product": "Product",
        "footer.features": "Features",
        "footer.howItWorks": "How It Works",
        "footer.pricing": "Pricing",
        "footer.api": "API Documentation",
        "footer.company": "Company",
        "footer.about": "About Us",
        "footer.careers": "Careers",
        "footer.blog": "Blog",
        "footer.contact": "Contact",
        "footer.legal": "Legal",
        "footer.privacy": "Privacy Policy",
        "footer.terms": "Terms of Service",
        "footer.cookies": "Cookie Policy",
        "footer.hipaa": "HIPAA Compliance",
        "footer.copyright": "© 2024 Mediमित्र. All rights reserved.",
        "footer.hipaaBadge": "HIPAA Compliant",
        "footer.security": "Bank-Level Security",
        "footer.uptime": "99.9% Uptime",

        // Chatbot
        "chatbot.placeholder": "Type your message...",
        "chatbot.greeting": "Hello! I'm your Mediमित्र AI Assistant. How can I help you today?",
        "chatbot.whatIs": "What is Mediमित्र?",
        "chatbot.aiCoding": "How does AI coding work?",
        "chatbot.hipaa": "Is it HIPAA compliant?",
        "chatbot.getStarted": "How to get started?"
    },
    hi: {
        // Navigation
        "signIn": "साइन इन",
        "getStarted": "मुफ्त शुरू करें",
        
        // Hero Section
        "hero.title": "आपका व्यक्तिगत AI <span>स्वास्थ्य सहयोगी</span>",
        "hero.subtitle": "बुद्धिमत्ता के साथ अस्पताल और बीमा वर्कफ़्लो को स्वचालित करना। हमारे AI-संचालित प्लेटफ़ॉर्म के साथ मेडिकल कोडिंग, क्लेम प्रोसेसिंग और रोगी प्रबंधन को सुव्यवस्थित करें।",
        "hero.startTrial": "मुफ्त ट्रायल शुरू करें",
        "hero.watchDemo": "डेमो देखें",
        "hero.accuracy": "सटीकता दर",
        "hero.timeSaved": "समय बचाया",
        "hero.support": "AI सपोर्ट",
        "hero.flowTitle": "AI प्रोसेसिंग फ्लो",
        "hero.flowSubtitle": "डॉक्यूमेंट → कोड → क्लेम",
        "hero.upload": "अपलोड",
        "hero.aiCoding": "AI कोडिंग",
        "hero.claim": "दावा",
        
        // Features
        "features.title": "शक्तिशाली सुविधाएं",
        "features.subtitle": "स्वास्थ्य सेवा प्रशासन को सुव्यवस्थित करने के लिए आपको जो कुछ भी चाहिए",
        "features.aiCoding": "AI-संचालित कोडिंग",
        "features.aiCodingDesc": "95% सटीकता के साथ मेडिकल दस्तावेजों से सटीक ICD-10 और CPT कोड स्वचालित रूप से सुझाता है।",
        "features.claims": "तत्काल दावा प्रसंस्करण",
        "features.claimsDesc": "घंटों के बजाय सेकंडों में बीमा दावे उत्पन्न करें और जमा करें। रीयल-टाइम ट्रैकिंग और स्थिति अपडेट।",
        "features.hipaa": "HIPAA अनुपालन",
        "features.hipaaDesc": "बैंक-स्तरीय सुरक्षा और HIPAA अनुपालन सुनिश्चित करता है कि आपका रोगी डेटा हमेशा सुरक्षित रहे।",
        "features.analytics": "विश्लेषण डैशबोर्ड",
        "features.analyticsDesc": "कोडिंग सटीकता, दावा स्थिति और वर्कफ़्लो दक्षता में व्यापक अंतर्दृष्टि।",
        "features.automation": "वर्कफ़्लो स्वचालन",
        "features.automationDesc": "दोहराए जाने वाले कार्यों को स्वचालित करें और अस्पताल और बीमा वर्कफ़्लो को एंड-टू-एंड सुव्यवस्थित करें।",
        "features.assistant": "AI सहायक",
        "features.assistantDesc": "24/7 AI सहायक प्रश्नों के उत्तर देने, कोडिंग मार्गदर्शन प्रदान करने और प्रश्नों को तुरंत हल करने के लिए।",
        
        // How It Works
        "works.title": "यह कैसे काम करता है",
        "works.subtitle": "आपके स्वास्थ्य सेवा प्रशासन को बदलने के लिए तीन सरल चरण",
        "works.step1": "दस्तावेज़ अपलोड करें",
        "works.step1Desc": "हमारे सुरक्षित पोर्टल के माध्यम से मेडिकल दस्तावेज, क्लिनिकल नोट्स, या रोगी रिकॉर्ड अपलोड करें।",
        "works.step2": "AI प्रोसेस और कोड",
        "works.step2Desc": "हमारा AI दस्तावेजों का विश्लेषण करता है और आत्मविश्वास स्कोर के साथ सटीक मेडिकल कोड सुझाता है।",
        "works.step3": "दावे उत्पन्न करें",
        "works.step3Desc": "एक क्लिक के साथ बीमा दावे बनाएं और उनकी स्थिति को रीयल-टाइम ट्रैक करें।",
        
        // Testimonials
        "testimonials.title": "स्वास्थ्य पेशेवरों द्वारा विश्वसनीय",
        "testimonials.subtitle": "देखें कि हमारे उपयोगकर्ता Mediमित्र के बारे में क्या कहते हैं",
        "testimonials.quote": "\"Mediमित्र ने हमारे कोडिंग समय में 70% की कमी की है और सटीकता में काफी सुधार किया है। AI सुझाव अविश्वसनीय रूप से सटीक हैं और हमारे पूरे वर्कफ़्लो को सुव्यवस्थित किया है।\"",
        "testimonials.author": "डॉ. सारा डेविस",
        "testimonials.position": "मुख्य चिकित्सा अधिकारी, सिटी हॉस्पिटल",
        
        // CTA
        "cta.title": "अपने स्वास्थ्य सेवा वर्कफ़्लो को बदलने के लिए तैयार हैं?",
        "cta.subtitle": "Mediमित्र का उपयोग करने वाले हजारों स्वास्थ्य पेशेवरों में शामिल हों",
        "cta.button": "अपना मुफ्त ट्रायल शुरू करें",
        "cta.noCard": "क्रेडिट कार्ड की आवश्यकता नहीं",
        "cta.quickStart": "2 मिनट में शुरू करें",
        
        // Footer
        "footer.description": "अस्पताल और बीमा वर्कफ़्लो को बुद्धिमत्ता के साथ स्वचालित करने के लिए आपका व्यक्तिगत AI स्वास्थ्य सहयोगी।",
        "footer.product": "उत्पाद",
        "footer.features": "विशेषताएं",
        "footer.howItWorks": "यह कैसे काम करता है",
        "footer.pricing": "मूल्य निर्धारण",
        "footer.api": "एपीआई दस्तावेज़ीकरण",
        "footer.company": "कंपनी",
        "footer.about": "हमारे बारे में",
        "footer.careers": "करियर",
        "footer.blog": "ब्लॉग",
        "footer.contact": "संपर्क करें",
        "footer.legal": "कानूनी",
        "footer.privacy": "गोपनीयता नीति",
        "footer.terms": "सेवा की शर्तें",
        "footer.cookies": "कुकी नीति",
        "footer.hipaa": "HIPAA अनुपालन",
        "footer.copyright": "© 2024 Mediमित्र। सर्वाधिकार सुरक्षित।",
        "footer.hipaaBadge": "HIPAA अनुपालन",
        "footer.security": "बैंक-स्तरीय सुरक्षा",
        "footer.uptime": "99.9% अपटाइम",

        // Chatbot
        "chatbot.placeholder": "अपना संदेश लिखें...",
        "chatbot.greeting": "नमस्ते! मैं आपका Mediमित्र AI सहायक हूँ। आज मैं आपकी कैसे मदद कर सकता हूँ?",
        "chatbot.whatIs": "Mediमित्र क्या है?",
        "chatbot.aiCoding": "AI कोडिंग कैसे काम करती है?",
        "chatbot.hipaa": "क्या यह HIPAA अनुपालन है?",
        "chatbot.getStarted": "कैसे शुरू करें?"
    },
    es: {
        // Navigation
        "signIn": "Iniciar Sesión",
        "getStarted": "Comenzar Gratis",
        
        // Hero Section
        "hero.title": "Tu Asistente de Salud <span>con IA Personal</span>",
        "hero.subtitle": "Automatizando flujos de trabajo hospitalarios y de seguros con inteligencia. Optimiza la codificación médica, el procesamiento de reclamos y la gestión de pacientes con nuestra plataforma impulsada por IA.",
        "hero.startTrial": "Comenzar Prueba Gratuita",
        "hero.watchDemo": "Ver Demostración",
        "hero.accuracy": "Tasa de Precisión",
        "hero.timeSaved": "Tiempo Ahorrado",
        "hero.support": "Soporte de IA",
        "hero.flowTitle": "Flujo de Procesamiento de IA",
        "hero.flowSubtitle": "Documento → Código → Reclamo",
        "hero.upload": "Subir",
        "hero.aiCoding": "Codificación con IA",
        "hero.claim": "Reclamo",
        
        // Features
        "features.title": "Características Poderosas",
        "features.subtitle": "Todo lo que necesitas para optimizar la administración de salud",
        "features.aiCoding": "Codificación con IA",
        "features.aiCodingDesc": "Sugiere automáticamente códigos ICD-10 y CPT precisos de documentos médicos con un 95% de precisión.",
        "features.claims": "Procesamiento Instantáneo de Reclamos",
        "features.claimsDesc": "Genera y envía reclamos de seguro en segundos en lugar de horas. Seguimiento en tiempo real y actualizaciones de estado.",
        "features.hipaa": "Cumple con HIPAA",
        "features.hipaaDesc": "Seguridad a nivel bancario y cumplimiento HIPAA garantizan que los datos de tus pacientes estén siempre protegidos.",
        "features.analytics": "Panel de Análisis",
        "features.analyticsDesc": "Información integral sobre precisión de codificación, estado de reclamos y eficiencia del flujo de trabajo.",
        "features.automation": "Automatización de Flujos",
        "features.automationDesc": "Automatiza tareas repetitivas y optimiza los flujos de trabajo hospitalarios y de seguros de extremo a extremo.",
        "features.assistant": "Asistente de IA",
        "features.assistantDesc": "Asistente de IA 24/7 para responder preguntas, proporcionar orientación de codificación y resolver consultas al instante.",
        
        // How It Works
        "works.title": "Cómo Funciona",
        "works.subtitle": "Tres simples pasos para transformar tu administración de salud",
        "works.step1": "Subir Documentos",
        "works.step1Desc": "Sube documentos médicos, notas clínicas o registros de pacientes a través de nuestro portal seguro.",
        "works.step2": "IA Procesa y Codifica",
        "works.step2Desc": "Nuestra IA analiza documentos y sugiere códigos médicos precisos con puntuaciones de confianza.",
        "works.step3": "Generar Reclamos",
        "works.step3Desc": "Crea reclamos de seguro con un clic y sigue su estado en tiempo real.",
        
        // Testimonials
        "testimonials.title": "Confiado por Profesionales de la Salud",
        "testimonials.subtitle": "Mira lo que dicen nuestros usuarios sobre Mediमित्र",
        "testimonials.quote": "\"Mediमित्र ha reducido nuestro tiempo de codificación en un 70% y mejorado significativamente la precisión. Las sugerencias de IA son increíblemente precisas y han optimizado todo nuestro flujo de trabajo.\"",
        "testimonials.author": "Dra. Sarah Davis",
        "testimonials.position": "Directora Médica, Hospital City",
        
        // CTA
        "cta.title": "¿Listo para Transformar tu Flujo de Trabajo de Salud?",
        "cta.subtitle": "Únete a miles de profesionales de la salud que usan Mediमित्र",
        "cta.button": "Comenzar Prueba Gratuita",
        "cta.noCard": "Sin tarjeta de crédito requerida",
        "cta.quickStart": "Comienza en 2 minutos",
        
        // Footer
        "footer.description": "Tu asistente de salud con IA personal para automatizar flujos de trabajo hospitalarios y de seguros con inteligencia.",
        "footer.product": "Producto",
        "footer.features": "Características",
        "footer.howItWorks": "Cómo Funciona",
        "footer.pricing": "Precios",
        "footer.api": "Documentación API",
        "footer.company": "Empresa",
        "footer.about": "Sobre Nosotros",
        "footer.careers": "Carreras",
        "footer.blog": "Blog",
        "footer.contact": "Contacto",
        "footer.legal": "Legal",
        "footer.privacy": "Política de Privacidad",
        "footer.terms": "Términos de Servicio",
        "footer.cookies": "Política de Cookies",
        "footer.hipaa": "Cumplimiento HIPAA",
        "footer.copyright": "© 2024 Mediमित्र. Todos los derechos reservados.",
        "footer.hipaaBadge": "Cumple con HIPAA",
        "footer.security": "Seguridad a Nivel Bancario",
        "footer.uptime": "99.9% Tiempo de Actividad",

        // Chatbot
        "chatbot.placeholder": "Escribe tu mensaje...",
        "chatbot.greeting": "¡Hola! Soy tu Asistente de IA de Mediमित्र. ¿Cómo puedo ayudarte hoy?",
        "chatbot.whatIs": "¿Qué es Mediमित्र?",
        "chatbot.aiCoding": "¿Cómo funciona la codificación IA?",
        "chatbot.hipaa": "¿Es compatible con HIPAA?",
        "chatbot.getStarted": "¿Cómo empezar?"
    },
    fr: {
        // Navigation
        "signIn": "Se Connecter",
        "getStarted": "Commencer Gratuitement",
        
        // Hero Section
        "hero.title": "Votre Compagnon Santé <span>IA Personnel</span>",
        "hero.subtitle": "Automatisation des workflows hospitaliers et d'assurance avec intelligence. Rationalisez le codage médical, le traitement des réclamations et la gestion des patients avec notre plateforme alimentée par l'IA.",
        "hero.startTrial": "Commencer l'Essai Gratuit",
        "hero.watchDemo": "Voir la Démo",
        "hero.accuracy": "Taux de Précision",
        "hero.timeSaved": "Temps Économisé",
        "hero.support": "Support IA",
        "hero.flowTitle": "Flux de Traitement IA",
        "hero.flowSubtitle": "Document → Code → Réclamation",
        "hero.upload": "Télécharger",
        "hero.aiCoding": "Codage IA",
        "hero.claim": "Réclamation",
        
        // Features
        "features.title": "Fonctionnalités Puissantes",
        "features.subtitle": "Tout ce dont vous avez besoin pour rationaliser l'administration des soins de santé",
        "features.aiCoding": "Codage par IA",
        "features.aiCodingDesc": "Suggère automatiquement des codes ICD-10 et CPT précis à partir de documents médicaux avec une précision de 95%.",
        "features.claims": "Traitement Instantané des Réclamations",
        "features.claimsDesc": "Générez et soumettez des réclamations d'assurance en secondes au lieu d'heures. Suivi en temps réel et mises à jour de statut.",
        "features.hipaa": "Conforme HIPAA",
        "features.hipaaDesc": "Sécurité de niveau bancaire et conformité HIPAA garantissent que les données de vos patients sont toujours protégées.",
        "features.analytics": "Tableau de Bord Analytique",
        "features.analyticsDesc": "Informations complètes sur la précision du codage, le statut des réclamations et l'efficacité du workflow.",
        "features.automation": "Automatisation des Workflows",
        "features.automationDesc": "Automatisez les tâches répétitives et rationalisez les workflows hospitaliers et d'assurance de bout en bout.",
        "features.assistant": "Assistant IA",
        "features.assistantDesc": "Assistant IA 24/7 pour répondre aux questions, fournir des conseils de codage et résoudre les requêtes instantanément.",
        
        // How It Works
        "works.title": "Comment Ça Marche",
        "works.subtitle": "Trois étapes simples pour transformer votre administration des soins de santé",
        "works.step1": "Télécharger des Documents",
        "works.step1Desc": "Téléchargez des documents médicaux, notes cliniques ou dossiers patients via notre portail sécurisé.",
        "works.step2": "IA Traite et Code",
        "works.step2Desc": "Notre IA analyse les documents et suggère des codes médicaux précis avec des scores de confiance.",
        "works.step3": "Générer des Réclamations",
        "works.step3Desc": "Créez des réclamations d'assurance en un clic et suivez leur statut en temps réel.",
        
        // Testimonials
        "testimonials.title": "Approuvé par les Professionnels de Santé",
        "testimonials.subtitle": "Découvrez ce que disent nos utilisateurs de Mediमित्र",
        "testimonials.quote": "\"Mediमित्र a réduit notre temps de codage de 70% et amélioré significativement la précision. Les suggestions d'IA sont incroyablement précises et ont rationalisé l'ensemble de notre flux de travail.\"",
        "testimonials.author": "Dr. Sarah Davis",
        "testimonials.position": "Directrice Médicale, Hôpital City",
        
        // CTA
        "cta.title": "Prêt à Transformer Votre Flux de Travail de Santé ?",
        "cta.subtitle": "Rejoignez des milliers de professionnels de santé utilisant Mediमित्र",
        "cta.button": "Commencer l'Essai Gratuit",
        "cta.noCard": "Aucune carte de crédit requise",
        "cta.quickStart": "Commencez en 2 minutes",
        
        // Footer
        "footer.description": "Votre compagnon santé IA personnel pour automatiser les workflows hospitaliers et d'assurance avec intelligence.",
        "footer.product": "Produit",
        "footer.features": "Fonctionnalités",
        "footer.howItWorks": "Comment Ça Marche",
        "footer.pricing": "Tarifs",
        "footer.api": "Documentation API",
        "footer.company": "Entreprise",
        "footer.about": "À Propos",
        "footer.careers": "Carrières",
        "footer.blog": "Blog",
        "footer.contact": "Contact",
        "footer.legal": "Légal",
        "footer.privacy": "Politique de Confidentialité",
        "footer.terms": "Conditions d'Utilisation",
        "footer.cookies": "Politique des Cookies",
        "footer.hipaa": "Conformité HIPAA",
        "footer.copyright": "© 2024 Mediमित्र. Tous droits réservados.",
        "footer.hipaaBadge": "Conforme HIPAA",
        "footer.security": "Sécurité de Niveau Bancaire",
        "footer.uptime": "99.9% Temps de Fonctionnement",

        // Chatbot
        "chatbot.placeholder": "Tapez votre message...",
        "chatbot.greeting": "Bonjour ! Je suis votre Assistant IA Mediमित्र. Comment puis-je vous aider aujourd'hui ?",
        "chatbot.whatIs": "Qu'est-ce que Mediमित्र ?",
        "chatbot.aiCoding": "Comment fonctionne le codage IA ?",
        "chatbot.hipaa": "Est-ce conforme à la HIPAA ?",
        "chatbot.getStarted": "Comment commencer ?"
    }
};

// Chatbot responses
const chatbotResponses = {
    "What is Mediमित्र?": "Mediमित्र is an AI-powered health companion that automates hospital and insurance workflows. It streamlines medical coding, claims processing, and patient management using advanced AI algorithms.",
    "How does AI coding work?": "Our AI analyzes medical documents, identifies key clinical terms, and suggests accurate ICD-10 and CPT codes with 95% accuracy. It learns from corrections to improve over time.",
    "Is it HIPAA compliant?": "Yes, Mediमित्र uses bank-level encryption and is fully HIPAA compliant. We ensure all patient data is securely handled and protected.",
    "How to get started?": "You can start with a free trial by clicking the 'Get Started Free' button. No credit card required. Set up takes just 2 minutes!",
    "What is Mediमित्र? (hi)": "Mediमित्र एक AI-संचालित स्वास्थ्य सहयोगी है जो अस्पताल और बीमा वर्कफ़्लो को स्वचालित करता है। यह उन्नत AI एल्गोरिदम का उपयोग करके मेडिकल कोडिंग, क्लेम प्रोसेसिंग और रोगी प्रबंधन को सुव्यवस्थित करता है।",
    "How does AI coding work? (hi)": "हमारा AI मेडिकल दस्तावेजों का विश्लेषण करता है, मुख्य नैदानिक शब्दों की पहचान करता है और 95% सटीकता के साथ सटीक ICD-10 और CPT कोड सुझाता है। यह सुधारों से सीखकर समय के साथ सुधार करता है।",
    "Is it HIPAA compliant? (hi)": "हां, Mediमित्र बैंक-स्तरीय एन्क्रिप्शन का उपयोग करता है और पूरी तरह से HIPAA अनुपालन है। हम सुनिश्चित करते हैं कि सभी रोगी डेटा सुरक्षित रूप से संभाला और संरक्षित है।",
    "How to get started? (hi)": "आप 'मुफ्त शुरू करें' बटन पर क्लिक करके मुफ्त ट्रायल से शुरुआत कर सकते हैं। क्रेडिट कार्ड की आवश्यकता नहीं है। सेटअप में केवल 2 मिनट लगते हैं!"
};

// DOM Elements
const themeToggle = document.getElementById('themeToggle');
const languageBtn = document.getElementById('languageBtn');
const languageDropdown = document.getElementById('languageDropdown');
const mobileLanguageToggle = document.getElementById('mobileLanguageToggle');
const mobileLanguageDropdown = document.getElementById('mobileLanguageDropdown');
const currentLanguageSpan = document.querySelector('.current-language');
const languageOptions = document.querySelectorAll('.language-option');
const mobileMenuBtn = document.getElementById('mobileMenuBtn');
const navLinksContainer = document.getElementById('navLinks');
const navLinks = document.querySelectorAll('.nav-link');
const footerLinks = document.querySelectorAll('.footer-links a');
const signInBtn = document.getElementById('signInBtn');
const getStartedBtn = document.getElementById('getStartedBtn');
const startFreeBtn = document.getElementById('startFreeBtn');
const watchDemoBtn = document.getElementById('watchDemoBtn');
const ctaGetStarted = document.getElementById('ctaGetStarted');

// Chatbot elements
const chatbotToggle = document.getElementById('chatbotToggle');
const chatbotWindow = document.getElementById('chatbotWindow');
const closeChat = document.getElementById('closeChat');
const chatBody = document.getElementById('chatBody');
const chatInput = document.getElementById('chatInput');
const sendMessage = document.getElementById('sendMessage');
const quickReplies = document.querySelectorAll('.quick-reply');

// Current language and theme
let currentLanguage = localStorage.getItem('mediMitraLanguage') || 'en';
let isDarkMode = localStorage.getItem('mediMitraDarkMode') === 'true';

// Initialize
function init() {
    // Apply saved theme
    if (isDarkMode) {
        document.body.classList.add('dark-mode');
        themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
    } else {
        themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
    }

    // Apply saved language
    applyLanguage(currentLanguage);
    updateActiveLanguageOption();

    // Setup event listeners
    setupEventListeners();
}

// Setup event listeners
function setupEventListeners() {
    // Theme toggle
    themeToggle.addEventListener('click', toggleTheme);

    // Language dropdown
    languageBtn.addEventListener('click', () => {
        languageDropdown.classList.toggle('active');
    });

    // Mobile language toggle
    mobileLanguageToggle.addEventListener('click', () => {
        mobileLanguageDropdown.classList.toggle('active');
    });

    // Language selection
    languageOptions.forEach(option => {
        option.addEventListener('click', (e) => {
            e.preventDefault();
            const lang = option.getAttribute('data-lang');
            changeLanguage(lang);
            languageDropdown.classList.remove('active');
            mobileLanguageDropdown.classList.remove('active');
        });
    });

    // Mobile menu
    mobileMenuBtn.addEventListener('click', () => {
        navLinksContainer.classList.toggle('active');
    });

    // Navigation links
    navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const section = link.getAttribute('data-section');
            scrollToSection(section);
            
            // Update active nav link
            navLinks.forEach(l => l.classList.remove('active'));
            link.classList.add('active');
            
            // Close mobile menu
            navLinksContainer.classList.remove('active');
        });
    });

    // Footer navigation links
    footerLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            const section = link.getAttribute('data-section');
            if (section) {
                e.preventDefault();
                scrollToSection(section);
            }
        });
    });

    // Chatbot functionality
    chatbotToggle.addEventListener('click', toggleChatbot);
    closeChat.addEventListener('click', toggleChatbot);
    
    // Send message on button click
    sendMessage.addEventListener('click', handleSendMessage);
    
    // Send message on Enter key
    chatInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            handleSendMessage();
        }
    });
    
    // Quick replies
    quickReplies.forEach(reply => {
        reply.addEventListener('click', () => {
            const question = reply.getAttribute('data-question');
            addMessage(question, 'user');
            handleBotResponse(question);
        });
    });

    // Close dropdowns when clicking outside
    document.addEventListener('click', (e) => {
        if (!languageBtn.contains(e.target) && !languageDropdown.contains(e.target)) {
            languageDropdown.classList.remove('active');
        }
        
        if (!mobileLanguageToggle.contains(e.target) && !mobileLanguageDropdown.contains(e.target)) {
            mobileLanguageDropdown.classList.remove('active');
        }
        
        // Close chatbot if clicking outside
        if (!chatbotToggle.contains(e.target) && !chatbotWindow.contains(e.target)) {
            chatbotWindow.classList.remove('active');
        }
    });

}

// Theme functions
function toggleTheme() {
    isDarkMode = !isDarkMode;
    
    if (isDarkMode) {
        document.body.classList.add('dark-mode');
        themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
    } else {
        document.body.classList.remove('dark-mode');
        themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
    }
    
    localStorage.setItem('mediMitraDarkMode', isDarkMode);
}

// Language functions
function changeLanguage(lang) {
    currentLanguage = lang;
    localStorage.setItem('mediMitraLanguage', lang);
    applyLanguage(lang);
    updateActiveLanguageOption();
}

function applyLanguage(lang) {
    const translation = translations[lang];
    
    // Update all elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translation[key]) {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translation[key];
            } else {
                element.innerHTML = translation[key];
            }
        }
    });

    // Update current language display
    currentLanguageSpan.textContent = getLanguageName(lang);
}

function updateActiveLanguageOption() {
    languageOptions.forEach(option => {
        const lang = option.getAttribute('data-lang');
        if (lang === currentLanguage) {
            option.classList.add('active');
        } else {
            option.classList.remove('active');
        }
    });
}

function getLanguageName(code) {
    const names = {
        'en': 'English',
        'hi': 'हिन्दी',
        'es': 'Español',
        'fr': 'Français'
    };
    return names[code] || 'English';
}

// Scroll to section
function scrollToSection(sectionId) {
    const section = document.getElementById(sectionId);
    if (section) {
        window.scrollTo({
            top: section.offsetTop - 80,
            behavior: 'smooth'
        });
    }
}

// Chatbot functions
function toggleChatbot() {
    chatbotWindow.classList.toggle('active');
    if (chatbotWindow.classList.contains('active')) {
        chatbotToggle.classList.remove('pulse');
        chatInput.focus();
    } else {
        chatbotToggle.classList.add('pulse');
    }
}

function addMessage(text, sender) {
    const messageDiv = document.createElement('div');
    messageDiv.classList.add('chat-message');
    messageDiv.classList.add(sender === 'user' ? 'user-message' : 'bot-message');
    messageDiv.textContent = text;
    
    chatBody.appendChild(messageDiv);
    chatBody.scrollTop = chatBody.scrollHeight;
}

function addTypingIndicator() {
    const typingDiv = document.createElement('div');
    typingDiv.classList.add('typing-indicator');
    typingDiv.innerHTML = `
        <span></span>
        <span></span>
        <span></span>
    `;
    
    chatBody.appendChild(typingDiv);
    chatBody.scrollTop = chatBody.scrollHeight;
    
    return typingDiv;
}

function removeTypingIndicator(indicator) {
    if (indicator && indicator.parentNode) {
        indicator.parentNode.removeChild(indicator);
    }
}

function handleSendMessage() {
    const message = chatInput.value.trim();
    if (message) {
        addMessage(message, 'user');
        chatInput.value = '';
        handleBotResponse(message);
    }
}

function handleBotResponse(userMessage) {
    const typingIndicator = addTypingIndicator();
    
    // Simulate AI thinking time
    setTimeout(() => {
        removeTypingIndicator(typingIndicator);
        
        let response = "";
        
        // Check for predefined responses
        if (userMessage.toLowerCase().includes('what is') || userMessage.toLowerCase().includes('mediमित्र')) {
            response = chatbotResponses["What is Mediमित्र?" + (currentLanguage === 'hi' ? ' (hi)' : '')] || 
                      chatbotResponses["What is Mediमित्र?"];
        } else if (userMessage.toLowerCase().includes('ai coding') || userMessage.toLowerCase().includes('how does')) {
            response = chatbotResponses["How does AI coding work?" + (currentLanguage === 'hi' ? ' (hi)' : '')] || 
                      chatbotResponses["How does AI coding work?"];
        } else if (userMessage.toLowerCase().includes('hipaa') || userMessage.toLowerCase().includes('compliant')) {
            response = chatbotResponses["Is it HIPAA compliant?" + (currentLanguage === 'hi' ? ' (hi)' : '')] || 
                      chatbotResponses["Is it HIPAA compliant?"];
        } else if (userMessage.toLowerCase().includes('start') || userMessage.toLowerCase().includes('get started')) {
            response = chatbotResponses["How to get started?" + (currentLanguage === 'hi' ? ' (hi)' : '')] || 
                      chatbotResponses["How to get started?"];
        } else {
            // Generic response for unknown queries
            response = currentLanguage === 'hi' 
                ? "मैं आपकी बात समझ गया। कृपया अपना प्रश्न अधिक विस्तार से पूछें या उपरोक्त विकल्पों में से किसी एक का चयन करें।"
                : "I understand you. Please ask your question in more detail or choose one of the options above.";
        }
        
        addMessage(response, 'bot');
    }, 1000 + Math.random() * 1000);
}

// Initialize on DOM load
document.addEventListener('DOMContentLoaded', init);

// Add this at the top of script.js (after translations object)
const BACKEND_URL = "http://localhost:8000";  // Change this to your backend URL
let chatSessionId = null;

// Add these functions to script.js (before the DOM elements section)

// Function to send message to backend
async function sendToBackend(message, language = 'en') {
    try {
        const response = await fetch(`${BACKEND_URL}/chat`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                message: message,
                session_id: chatSessionId,
                language: language
            })
        });

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        
        // Store session ID if we get a new one
        if (data.session_id) {
            chatSessionId = data.session_id;
            localStorage.setItem('mediMitraSessionId', chatSessionId);
        }
        
        return data.reply;
        
    } catch (error) {
        console.error('Error connecting to backend:', error);
        
        // Fallback to local responses if backend is down
        const fallbackResponses = {
            "en": "I'm currently experiencing connection issues. Please try again in a moment.",
            "hi": "मैं वर्तमान में कनेक्शन समस्याओं का सामना कर रहा हूं। कृपया कुछ क्षण बाद पुन: प्रयास करें।",
            "es": "Actualmente estoy experimentando problemas de conexión. Por favor, inténtelo de nuevo en un momento.",
            "fr": "Je rencontre actuellement des problèmes de connexion. Veuillez réessayer dans un moment."
        };
        
        return fallbackResponses[language] || fallbackResponses.en;
    }
}

// Function to upload document
async function uploadDocument(file) {
    const formData = new FormData();
    formData.append('file', file);
    
    try {
        addMessage(`Uploading ${file.name}...`, 'user');
        
        const response = await fetch(`${BACKEND_URL}/upload`, {
            method: 'POST',
            body: formData
        });
        
        const data = await response.json();
        
        if (data.error) {
            addMessage(`Upload failed: ${data.error}`, 'bot');
        } else {
            const summary = data.extracted_text.substring(0, 200) + '...';
            addMessage(`✅ Document uploaded successfully!\n\nExtracted text (${data.char_count} chars):\n${summary}`, 'bot');
            
            // Auto-analyze the document
            const analysisPrompt = `Please analyze this medical document and provide a summary:\n\n${data.extracted_text.substring(0, 1000)}`;
            handleBotResponse(analysisPrompt);
        }
        
    } catch (error) {
        console.error('Upload error:', error);
        addMessage('Failed to upload document. Please try again.', 'bot');
    }
}

// Update the handleBotResponse function
function handleBotResponse(userMessage) {
    const typingIndicator = addTypingIndicator();
    
    // Send to backend
    sendToBackend(userMessage, currentLanguage)
        .then(response => {
            removeTypingIndicator(typingIndicator);
            addMessage(response, 'bot');
        })
        .catch(error => {
            removeTypingIndicator(typingIndicator);
            addMessage('Sorry, I encountered an error. Please try again.', 'bot');
            console.error('Chat error:', error);
        });
}

// Add file upload functionality to the chat
function addFileUpload() {
    // Create file input
    const fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.id = 'chatFileInput';
    fileInput.style.display = 'none';
    fileInput.accept = '.pdf,.png,.jpg,.jpeg,.bmp,.tiff';
    
    // Add event listener
    fileInput.addEventListener('change', (e) => {
        const file = e.target.files[0];
        if (file) {
            // Check file size (max 10MB)
            if (file.size > 10 * 1024 * 1024) {
                addMessage('File is too large. Maximum size is 10MB.', 'bot');
                return;
            }
            
            uploadDocument(file);
        }
        // Reset input
        fileInput.value = '';
    });
    
    // Add upload button to chat input container
    const uploadButton = document.createElement('button');
    uploadButton.type = 'button';
    uploadButton.className = 'upload-button';
    uploadButton.innerHTML = '<i class="fas fa-paperclip"></i>';
    uploadButton.title = 'Upload document';
    
    uploadButton.addEventListener('click', () => {
        fileInput.click();
    });
    
    // Insert before send button
    const sendButton = document.getElementById('sendMessage');
    sendButton.parentNode.insertBefore(uploadButton, sendButton);
    sendButton.parentNode.insertBefore(fileInput, uploadButton);
    
    // Add CSS for upload button
    const style = document.createElement('style');
    style.textContent = `
        .upload-button {
            background: none;
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 18px;
            padding: 10px;
            border-radius: 50%;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .upload-button:hover {
            background-color: var(--bg-tertiary);
            color: var(--primary);
        }
        
        .chat-input-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .chat-input {
            flex: 1;
        }
    `;
    document.head.appendChild(style);
}

// Update the init function to initialize session
function init() {
    // Apply saved theme
    if (isDarkMode) {
        document.body.classList.add('dark-mode');
        themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
    } else {
        themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
    }

    // Apply saved language
    applyLanguage(currentLanguage);
    updateActiveLanguageOption();
    
    // Initialize chat session
    chatSessionId = localStorage.getItem('mediMitraSessionId') || null;
    
    // Add file upload functionality
    addFileUpload();
    
    // Test backend connection
    testBackendConnection();

    // Setup event listeners
    setupEventListeners();
}

// Function to test backend connection
async function testBackendConnection() {
    try {
        const response = await fetch(`${BACKEND_URL}/health`);
        if (response.ok) {
            console.log('✅ Backend connected successfully');
        }
    } catch (error) {
        console.warn('⚠️ Backend not available, using fallback responses');
    }
}
const DOC_API = "http://127.0.0.1:8001";

async function upload() {
    const file = document.getElementById("fileInput").files[0];
    if (!file) return alert("Select PDF");

    const formData = new FormData();
    formData.append("file", file);

    const res = await fetch(`${DOC_API}/upload`, {
        method: "POST",
        body: formData
    });

    const data = await res.json();
    document.getElementById("output").textContent =
        JSON.stringify(data, null, 2);
}

async function ask() {
    const question = document.getElementById("question").value;
    if (!question) return alert("Enter question");

    const res = await fetch(`${DOC_API}/ask`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ question })
    });

    const data = await res.json();
    document.getElementById("output").textContent =
        data.answer || JSON.stringify(data, null, 2);
}
